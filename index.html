<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="UTF-8"/>
    <title>Shamir's Keystore</title>
    <style>
      @import url('https://fonts.googleapis.com/css?family=Crimson+Text|Fira+Code|Montserrat&amp;display=swap');
      div.main {
        width: 80%; border-style: outset; border-width: 1px; border-radius: 3px; border-color: rgb(224,224,224); margin-left: auto; margin-right: auto;
        padding-left: 1em; padding-right: 1em; padding-top: 0.25em; padding-bottom: 0.25em; background-color: rgb(224,224,224)
      }
      p.headline-0 {
        background-color: rgb(178,24,43); color: rgb(253,219,199); font-family: 'Montserrat', sans-serif; padding: 3px; border-radius: 3px; font-size: 1.5em; padding-left: 1rem
      }
      p.headline-1 {
        background-color: rgb(77,77,77); color: rgb(253,219,199); font-family: 'Montserrat', sans-serif; padding: 3px; border-radius: 3px; font-size: 1em; padding-left: 1rem
      }
      p.section {
        color: rgb(26,26,26); font-family: 'Crimson Text', serif; text-align: justify
      }
      div.code {
        border-style: dashed; border-width: 1px; border-color: rgb(103,0,31); background-color: rgb(253,219,199); width: 60%; margin-left: auto; margin-right: auto
      }
      p.code {
        font-family: 'Fira Code', monospace; font-size: 12px; text-align: left; padding-left: 1rem
      }
      p.formula {
        font-style: italic; font-family: 'Fira Code', monospace; text-align: center
      }
      span.formula {
        font-style: italic; font-family: 'Fira Code', monospace;
      }
    </style>
  </head>
  <body style="background-color: rgb(255,255,255)">
    <div class="main">
      <p class="headline-0">Shamir's Keystore</p>
      <p class="headline-1">Abstract</p>
      <p class="section">
        This <a href="https://docs.oracle.com/en/java/javase/11/security/java-cryptography-architecture-jca-reference-guide.html">JCA provider</a> presently implements 
        <a href="https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing">Shamir's Secret Sharing</a> using
        Newton's Polynomials. Building on this, a <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/security/KeyStore.html">KeyStore</a> Engine
        as defined by the <a href="https://docs.oracle.com/en/java/javase/11/security/howtoimplaprovider.html">Java Cryptographic Architecture</a> is provided. Such a keystore instance might 
        be unlocked - apart from the master password - by a previously computed subset of secret shares. In order to be able to reconstruct the master password a certain number of secret shares 
        above a given threshold must be combined. Shamirs scheme is information-theoretically secure. This means that an attacker does not get any additional information about the original master 
        password with fewer shares as defined by the given threshold. In this way, it is possible to enforce the e.g. the four-eye-principle.
      </p>
      <p class="headline-1">Build</p>
      <p class="section">
        First clone the project:
      </p>
      <div class="code">
        <p class="code">
          git clone https://github.com/chr78rm/shamirs-keystore.git<br/>
          cd shamirs-keystore
        </p>
      </div>
      <p class="section">
        <a href="https://maven.apache.org/">Maven</a> and a JDK11+ is required for the build of the multi-module project:
      </p>
      <div class="code">
        <p class="code">
          mvn clean package -P production
        </p>
      </div>
      <p class="section">
        Above command will compile the sources, run the tests and package the provider archive.
      </p>
      <p class="headline-1">The Algorithm</p>
      <p class="section" style="">
        Consider the polynom 
      </p>
      <p class="formula">
        P<sub>k-1</sub>(x) = a<sub>k-1</sub>x<sup>k-1</sup> + ... + a<sub>2</sub>x<sup>2</sup> + a<sub>1</sub>x + a<sub>0</sub>
      </p>
      <p class="section" style="">
        of degree <span class="formula">k-1</span>. Recall that you need <span class="formula">k</span> supporting points to recover a polynomial of
        degree <span class="formula">k-1</span>. Shamir's <span class="formula">(k,n)</span> threshold scheme is building upon this property. A trusted 
        authority randomly selects a polynomial <span class="formula">P<sub>k-1</sub></span> and computes <span class="formula">n</span> supporting points whereby 
        <span class="formula">n >= k</span> applies. 
        The to be shared secret <span class="formula">s</span> is encoded as <span class="formula">a<sub>0</sub></span>. The <span class="formula">n</span> supporting points 
        are distributed among the participants. To compute the original secret <span class="formula">s</span> the participants must combine <span class="formula">k</span> of 
        the supporting points. In order to avoid that an attacker gains any knowledge about the secret by merging less than <span class="formula">k</span> supporting points 
        all computations will by implemented by using finite field arithmetic. That means we choose a finite field <span class="formula">&#120125;<sub>p</sub></span> whereby 
        <span class="formula">p</span> is prime and <span class="formula">a<sub>0</sub> < p</span> applies.
      </p> 
      <div style="text-align: center; border-top-style: solid; border-top-color: rgb(26,26,26); border-top-width: 1px; margin-top: 1rem">
        <img style="" src="./impressum.png" alt="Impressum" />
      </div>
    </div>
  </body>
</html>